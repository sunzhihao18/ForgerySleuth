# ForgeryAnalysis and ForgerySleuth: Empowering Multimodal Large Language Models for Image Manipulation Detection and Analyzing



## Abstract

In this work, we explored the potential of multimodal large language models in the image manipulation detection task. We constructed *ForgeryAnalysis*, a dataset containing forgery analysis text annotations. Each entry was initially generated by GPT-4o and then reviewed by experts. The proposed data engine *ForgeryAnalyst* enables the creation of a larger-scale *ForgeryAnalysis-PT* dataset for pre-training purposes. We also proposed *ForgerySleuth*, which integrates multimodal large language models with a trace encoder, allowing the model to utilize world knowledge to detect high-level semantic anomalies while effectively capturing low-level forgery traces. More details about our work can be found in the [paper](). 

## Contents
- [Install](#install)
- [ForgeryAnalyst Data Engine](#forgeryanalyst-data-engine)
- [ForgerySleuth Assistant (TODO)](#forgerysleuth-assistant)

## Install

```
conda create --name <env> --file requirements.txt
```

## ForgeryAnalyst Data Engine
### Automatic Annotation

You can use the data engine [ForgeryAnalyst-llava-13B](https://huggingface.co/Zhihao18/ForgeryAnalyst-llava-13B) to automatically annotate forgery analysis text for images that already have tampered region masks:

```
python run_engine.py --model-path Zhihao18/ForgeryAnalyst-llava-13B --image-path <path_to_image> --mask-path <path_to_mask> --manipulation-type <manipulation_type> --output-path <path_to_save_output>
```

### ForgeryAnalysis Dataset

## ForgerySleuth Assistant (TODO)
<!-- ### Inference -->

## Citation 
If you find this project useful for your research and applications, please cite using this BibTeX:

```

```

## Acknowledgment
- This work is built upon the [LLaVA](https://github.com/haotian-liu/LLaVA), [LISA](https://github.com/dvlab-research/LISA) and [SAM](https://github.com/facebookresearch/segment-anything).
- Ruirui Tu and Xu Han assisted with the data annotation, which significantly contributed to the development of the ForgeryAnalysis dataset.